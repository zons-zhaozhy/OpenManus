"""需求评审提示词模板"""

REQUIREMENTS_REVIEW_PROMPT = """你是一位专业的需求分析专家，请基于以下维度评估需求的质量：

1. 业务价值 (Business Value)
- 需求是否源自实际业务需要？
- 能否带来明确的价值？
- 是否符合项目目标？
- 是否有可量化的收益？
- 投资回报率如何？

2. SMART原则 (SMART Principles)
- Specific（具体）：需求是否足够具体？是否避免模糊描述？
- Measurable（可衡量）：是否有明确的度量标准？如何衡量成功？
- Achievable（可达成）：在现有条件下是否可实现？有哪些限制因素？
- Relevant（相关）：是否与业务目标相关？是否符合项目范围？
- Time-bound（时限）：是否有明确的时间要求？里程碑是否合理？

3. 完整性 (Completeness)
- 功能需求是否完整？
- 非功能需求是否完整？
- 业务规则是否完整？
- 异常场景是否完整？
- 数据需求是否完整？
- 接口需求是否完整？
- 安全需求是否完整？

4. 一致性 (Consistency)
- 术语使用是否统一？
- 描述是否一致？
- 优先级是否合理？
- 需求之间是否存在冲突？
- 是否与现有系统兼容？
- 是否与业务流程一致？

5. 可验证性 (Testability)
- 是否有明确的验收标准？
- 验收标准是否可测试？
- 是否包含必要的测试场景？
- 是否考虑了边界条件？
- 是否定义了性能指标？
- 是否有明确的质量要求？

请对每个维度进行评分（0-100），并提供具体的改进建议。
如果发现严重问题，请标记为阻塞项。
评分时请考虑以下因素：
- 90-100分：卓越，几乎没有改进空间
- 80-89分：优秀，有少量改进空间
- 70-79分：良好，需要适当改进
- 60-69分：及格，需要明显改进
- 60分以下：不及格，需要重大改进

对于每个评分低于80分的维度，请提供具体的改进建议。
对于每个评分低于60分的维度，请标记为阻塞项。
"""

REQUIREMENTS_REVIEW_EXAMPLE = """
输入需求：
{
    "project_scope": [
        "开发一个在线教育平台",
        "支持课程管理、学习管理和考试系统",
        "目标用户为高校和培训机构"
    ],
    "user_roles": [
        "管理员：负责系统配置和用户管理",
        "教师：负责课程内容管理和考试管理",
        "学生：参与课程学习和考试"
    ],
    "core_features": [
        "课程管理：支持课程创建、编辑、发布",
        "学习管理：支持课程学习、进度跟踪",
        "考试系统：支持在线考试、自动评分",
        "统计分析：支持学习数据分析和报告生成"
    ],
    "constraints": [
        "系统需要支持并发用户1000+",
        "页面响应时间不超过2秒",
        "支持主流浏览器访问"
    ]
}

评估结果：
1. 业务价值：85分
✓ 明确针对在线教育市场需求
✓ 目标用户群体清晰
✓ 功能模块符合教育场景
✗ 缺少具体的价值量化指标
建议：
- 添加预期的市场规模和收益指标
- 明确与竞品的差异化优势
- 补充具体的商业模式说明

2. SMART原则：75分
✓ 功能模块划分清晰
✓ 性能指标可衡量
✗ 部分功能描述过于简单
✗ 缺少具体的时间规划
建议：
- 细化每个功能模块的具体要求
- 添加项目实施的时间节点
- 明确各阶段的验收标准

3. 完整性：65分
✓ 基本功能模块完整
✗ 缺少用户权限详细说明
✗ 缺少数据安全要求
✗ 未说明集成需求
阻塞项：需要补充以下内容
- 用户权限矩阵
- 数据安全和隐私保护要求
- 与其他系统的集成需求
建议：
- 补充非功能性需求
- 添加数据备份和恢复方案
- 明确系统可用性要求

4. 一致性：80分
✓ 术语使用统一
✓ 功能描述风格一致
✓ 约束条件明确
✗ 优先级未标注
建议：
- 为功能模块添加优先级标记
- 检查功能间的依赖关系
- 验证与现有系统的兼容性

5. 可验证性：70分
✓ 性能指标明确
✗ 缺少功能验收标准
✗ 测试场景不完整
建议：
- 补充每个功能的验收标准
- 添加性能测试场景
- 明确兼容性测试要求

总体建议：
1. 完善非功能性需求
2. 添加详细的验收标准
3. 补充项目实施计划
4. 明确优先级和依赖关系
5. 加强安全性要求说明
"""


def format_requirements_review_prompt(requirements: dict) -> str:
    """格式化需求评审提示词"""
    return f"{REQUIREMENTS_REVIEW_PROMPT}\n\n需求内容：\n{requirements}"
